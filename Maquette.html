<!DOCTYPE html>
<html>
    <head>
	  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	  <meta name="viewport" content="width=device-width, user-scalable=no">
	  <title>VivaGraphs test page</title>

	  <script src="../dist/vivagraph.js"></script>
	  <script type='text/javascript'>
        function appartient(tab, string){
			for (i = 0; i < tab.length; ++i){
				if (tab[i] == string)
					return true;
			}
			return false;
		}	

		/*global Viva, $*/
		function onLoad() {
		    var d3Sample = function(){
				var g = Viva.Graph.graph();
				g.Name = "Sample graph from d3 library";

				g.addNode('Rock', {"type" : "music", "style" : ['guitar'], "r" :10});
				g.addNode('Jazz', {"type" : "music", "style" : ['piano'], "r" :10});
				g.addNode('Electro', {"type" : "music", "style" : ['dj'], "r" :10});

				var listStyles = ['Rock', 'Jazz', 'Electro'];
				
				for (j = 0; j < listStyles.length; ++j) {
					
					for(i =0; i < 10; ++i){
						var name = listStyles[j];
						var sndname = name+i;
						g.addNode(sndname, {"name" : sndname , "type" : "artist", "style" : [name], "r" :5});
						g.addLink(name, sndname);
					}
				}


			  return g;
		    };

/*			var colors = [
				"#ffffff", // 1
				"#1f77b4",
				"#aec7e8",
				"#ff7f0e",
				"#ffbb78",
				"#2ca02c",
				"#98df8a",
				"#d62728",
				"#ff9896",
				"#9467bd",
				"#c5b0d5",
				"#8c564b",
				"#c49c94",
				"#e377c2",
				"#f7b6d2",
				"#7f7f7f",
				"#c7c7c7",
				"#bcbd22",
				"#dbdb8d",
				"#17becf",
				"#9edae5"
			];*/

		     var example = function() {
			  var graph = d3Sample();

			  var layout = Viva.Graph.Layout.forceDirected(graph, {
				springLength : 35,
				springCoeff : 0.00055,
				dragCoeff : 0.09,
				gravity : -1
			  });

			  var svgGraphics = Viva.Graph.View.svgGraphics();
			  svgGraphics.node(function(node){
					var rfill = appartient(node.data.style, 'Rock') ? 'FF' : '00';
					var gfill = appartient(node.data.style, 'Jazz') ? 'FF' : '00';
					var bfill = appartient(node.data.style, 'Electro') ? 'FF' : '00';
					var fillCollins = "#"+rfill+gfill+bfill;

					var circle = Viva.Graph.svg('circle')
					.attr('r', node.data.r)
					.attr('stroke', '#AAA')
					.attr('stroke-width', '0.5px')
					.attr("fill", fillCollins);
					circle.append('title').text(node.data.name);

				return circle;

				}).placeNode(function(nodeUI, pos){
				nodeUI.attr( "cx", pos.x).attr("cy", pos.y);
			  });

			  svgGraphics.link(function(link){
				return Viva.Graph.svg('line')
					  .attr('stroke', '#222')
					  .attr('stroke-width', Math.sqrt(link.data));
			  });

			  var renderer = Viva.Graph.View.renderer(graph, {
				container : document.getElementById('graph1'),
				layout : layout,
				graphics : svgGraphics,
				prerender: 20,
				renderLinks : true
			  });

			  renderer.run(500);
		    }();
		}
	  </script>
	  <style type='text/css'>
		#graph1{
		    position: absolute;
		    vertical-align:middle;
		    width: 100%;
		    height: 100%;
		}
		#graph1 > svg {
		    width: 100%;
		    height: 100%;
		}
	  </style>
    </head>
    <body onload='onLoad()' style='width:100%; height: 100%; position : absolute; background: #000;'>
	  <div style='width:100%; height:100%; position:absolute;'>
		<div id='graph1' ></div>
	  </div>
    </body>
</html>
