<!DOCTYPE html>
<html>
<head>
    <title>TestPage</title>
    <script type="text/javascript" src="../dist/vivagraph.js"></script>
    <script type="text/javascript">
        function appartient(tab, string){
			for (i = 0; i < tab.length; ++i){
				if (tab[i] == string)
					return true;
			}
			return false;
		}	
		function main () {
            // Step 1. We create a graph object.
            var graph = Viva.Graph.graph();

            // Step 2. We add nodes and edges to the graph:
			graph.addNode('Rock', {"genre" : "music", "style" : 'guitar', "width" :24, "height":24, "stroke" : "red"});
			graph.addNode('Jazz', {"genre" : "music", "style" : 'piano', "width" :24, "height":24, "stroke" : "red"});
			graph.addNode('Electro', {"genre" : "music", "style" : 'dj', "width" :24, "height":24, "stroke" : "red"});
			
			var listStyles = ['Rock', 'Jazz', 'Electro'];
			
			for (j = 0; j < listStyles.length; ++j) {
				
				for(i =0; i < 10; ++i){
					var name = listStyles[j];
					var sndname = name+i;
					graph.addNode(sndname, {"style" : [name], "width" :24, "height":24});
					graph.addLink(name, sndname);
				}
			}
			
			var graphics = Viva.Graph.View.svgGraphics();
			
			graphics.node(function(node) {
                // node.data holds custom object passed to graph.addNode():
				
				if (node.data){
					var url = 'img/' + node.data.style + '.png';

					if (node.data.genre){
						return Viva.Graph.svg('image')
						.attr('width', node.data.width)
						.attr('height', node.data.height)
						.link(url);
					}
					else{
						var rfill;
						var gfill;
						var bfill;		
						
						rfill = appartient(node.data.style, 'Rock') ? 'FF' : '00';
						gfill = appartient(node.data.style, 'Jazz') ? 'FF' : '00';
						bfill = appartient(node.data.style, 'Electro') ? 'FF' : '00';
												var fillCollins = "#"+rfill+gfill+bfill;
						
						var viva = Viva.Graph.svg('circle')
							.attr('r', 5)
							.attr('fill', fillCollins);
							
						viva.append('title').text(node.data.name);
						
						return viva;
					}
				}
				else{
					var url = 'img/default.png';
					return Viva.Graph.svg('image')
					.attr('width', 24)
					.attr('height', 24)
					.link(url);
				}
				});
			
			/*graphics.placeNode(function(nodeUI, pos) {
                // nodeUI - is exactly the same object that we returned from
                //   node() callback above.
                // pos - is calculated position for this node.
                nodeUI.attr('x', pos.x - 12).attr('y', pos.y - 12);
            });*/
            /* Note: graph.addLink() creates new nodes if they are not yet
               present in the graph. Thus calling this method is equivalent to:

               graph.addNode(1);
               graph.addNode(2);
               graph.addLink(1, 2);
            */
			
            // Step 3. Render the graph.
			
            var renderer = Viva.Graph.View.renderer(graph, {
                    graphics : graphics
                });
            renderer.run();
			
        }
		
    </script>

    <style type="text/css" media="screen">
        html, body, svg { width: 100%; height: 100%;}
    </style>
</head>
<body onload='main()'>

</body>
</html>
